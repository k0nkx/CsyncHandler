function Csync:updateOffscreenIndicator()
    if not self.VisualsEnabled then 
        if self.Instances.mainContainer then
            self.Instances.mainContainer.Visible = false
        end
        return 
    end
    if not self.Instances.desyncVisual then return end
    
    local desyncPos = self.Instances.desyncVisual.Position
    local screenPoint = self.Camera:WorldToViewportPoint(desyncPos)
    
    if screenPoint.Z > 0 and 
       screenPoint.X >= 0 and screenPoint.X <= self.Camera.ViewportSize.X and
       screenPoint.Y >= 0 and screenPoint.Y <= self.Camera.ViewportSize.Y then
        
        if self.Instances.mainContainer then
            self.Instances.mainContainer.Visible = false
        end
        return
    end
    
    if not self.Instances.mainContainer then return end
    
    self.Instances.mainContainer.Visible = true
    
    local screenSize = self.Camera.ViewportSize
    local x, y = screenPoint.X, screenPoint.Y
    
    local leftDist = x
    local rightDist = screenSize.X - x
    local topDist = y
    local bottomDist = screenSize.Y - y
    
    local isLeft = x < 0
    local isRight = x > screenSize.X
    local isTop = y < 0
    local isBottom = y > screenSize.Y
    
    local isBehind = screenPoint.Z <= 0
    
    local edgeThickness = 3
    local visibleColor = Color3.fromRGB(255, 0, 0)
    
    if isBehind then
        local posX = screenSize.X/2
        local posY = screenSize.Y/2
        
        local dx = posX - screenSize.X/2
        local dy = posY - screenSize.Y/2
        local distance = math.sqrt(dx*dx + dy*dy)
        
        local maxDist = math.min(screenSize.X, screenSize.Y) * 0.45
        
        if distance > 0 then
            posX = screenSize.X/2 + dx/distance * maxDist
            posY = screenSize.Y/2 + dy/distance * maxDist
        end
        
        local edge = self:getClosestEdge(posX, posY)
        
        self.Instances.topEdge.Visible = (edge == "top")
        self.Instances.bottomEdge.Visible = (edge == "bottom")
        self.Instances.leftEdge.Visible = (edge == "left")
        self.Instances.rightEdge.Visible = (edge == "right")
        
        local edgeLengthPercent = 0.2
        
        if edge == "top" then
            local edgeLength = screenSize.X * edgeLengthPercent
            self.Instances.topEdge.Size = UDim2.new(0, edgeLength, 0, edgeThickness)
            self.Instances.topEdge.Position = UDim2.new(0, screenSize.X/2 - edgeLength/2, 0, 5)
        elseif edge == "bottom" then
            local edgeLength = screenSize.X * edgeLengthPercent
            self.Instances.bottomEdge.Size = UDim2.new(0, edgeLength, 0, edgeThickness)
            self.Instances.bottomEdge.Position = UDim2.new(0, screenSize.X/2 - edgeLength/2, 1, -edgeThickness - 5)
        elseif edge == "left" then
            local edgeLength = screenSize.Y * edgeLengthPercent
            self.Instances.leftEdge.Size = UDim2.new(0, edgeThickness, 0, edgeLength)
            self.Instances.leftEdge.Position = UDim2.new(0, 5, 0, screenSize.Y/2 - edgeLength/2)
        elseif edge == "right" then
            local edgeLength = screenSize.Y * edgeLengthPercent
            self.Instances.rightEdge.Size = UDim2.new(0, edgeThickness, 0, edgeLength)
            self.Instances.rightEdge.Position = UDim2.new(1, -edgeThickness - 5, 0, screenSize.Y/2 - edgeLength/2)
        end
        
        self.Instances.topLeftCorner.Visible = false
        self.Instances.topRightCorner.Visible = false
        self.Instances.bottomLeftCorner.Visible = false
        self.Instances.bottomRightCorner.Visible = false
        
    else
        local cornerRadius = 50
        
        local showTop = isTop
        local showBottom = isBottom
        local showLeft = isLeft
        local showRight = isRight
        
        local showCorner = false
        
        if showTop and showLeft then
            self.Instances.topLeftCorner.Visible = true
            self.Instances.topLeftCorner.Rotation = 0
            showCorner = true
        else
            self.Instances.topLeftCorner.Visible = false
        end
        
        if showTop and showRight then
            self.Instances.topRightCorner.Visible = true
            self.Instances.topRightCorner.Rotation = 90
            showCorner = true
        else
            self.Instances.topRightCorner.Visible = false
        end
        
        if showBottom and showLeft then
            self.Instances.bottomLeftCorner.Visible = true
            self.Instances.bottomLeftCorner.Rotation = 270
            showCorner = true
        else
            self.Instances.bottomLeftCorner.Visible = false
        end
        
        if showBottom and showRight then
            self.Instances.bottomRightCorner.Visible = true
            self.Instances.bottomRightCorner.Rotation = 180
            showCorner = true
        else
            self.Instances.bottomRightCorner.Visible = false
        end
        
        if showCorner then
            self.Instances.topEdge.Visible = false
            self.Instances.bottomEdge.Visible = false
            self.Instances.leftEdge.Visible = false
            self.Instances.rightEdge.Visible = false
        else
            local edgeLengthPercent = 0.2
            local edgeLength = screenSize.X * edgeLengthPercent
            
            self.Instances.topEdge.Visible = showTop
            if showTop then
                local clampedX = math.clamp(x, edgeLength/2, screenSize.X - edgeLength/2)
                self.Instances.topEdge.Size = UDim2.new(0, edgeLength, 0, edgeThickness)
                self.Instances.topEdge.Position = UDim2.new(0, clampedX - edgeLength/2, 0, 5)
            end
            
            self.Instances.bottomEdge.Visible = showBottom
            if showBottom then
                local clampedX = math.clamp(x, edgeLength/2, screenSize.X - edgeLength/2)
                self.Instances.bottomEdge.Size = UDim2.new(0, edgeLength, 0, edgeThickness)
                self.Instances.bottomEdge.Position = UDim2.new(0, clampedX - edgeLength/2, 1, -edgeThickness - 5)
            end
            
            self.Instances.leftEdge.Visible = showLeft
            if showLeft then
                local clampedY = math.clamp(y, edgeLength/2, screenSize.Y - edgeLength/2)
                self.Instances.leftEdge.Size = UDim2.new(0, edgeThickness, 0, edgeLength)
                self.Instances.leftEdge.Position = UDim2.new(0, 5, 0, clampedY - edgeLength/2)
            end
            
            self.Instances.rightEdge.Visible = showRight
            if showRight then
                local clampedY = math.clamp(y, edgeLength/2, screenSize.Y - edgeLength/2)
                self.Instances.rightEdge.Size = UDim2.new(0, edgeThickness, 0, edgeLength)
                self.Instances.rightEdge.Position = UDim2.new(1, -edgeThickness - 5, 0, clampedY - edgeLength/2)
            end
        end
    end
end
